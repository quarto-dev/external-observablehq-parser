import {terser} from "rollup-plugin-terser";
import * as meta from "./package.json";

const copyright = `// @observablehq/parser v${meta.version} Copyright ${(new Date).getFullYear()} Observable, Inc.`;
const forkCopyright = `// @quarto/external-observablehq-parser v${meta.version} fork changes are Copyright ${(new Date).getFullYear()} RStudio, PBC.\n${copyright}`;

import theirBase from "./rollup.config.js";
const base = theirBase[0];

base.plugins = [
  terser({
    output: {preamble: forkCopyright},
    mangle: {reserved: ["RequireError"]},
  })
];
base.output.format = "esm";
base.output.name = "quarto-dev/external-observablehq-parser";
base.output.file =  "dist/external-observablehq-parser.min.js";

export default [ base ];